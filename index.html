<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Equipment Criticality Assessment System</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button.active { background-color: #3b82f6; color: white; }
        .editable-cell { cursor: pointer; position: relative; }
        .editable-cell:hover { background-color: #f0f9ff; }
        .tier-critical { background-color: #fee2e2; }
        .tier-high { background-color: #fed7aa; }
        .tier-medium { background-color: #fef3c7; }
        .tier-low { background-color: #dcfce7; }
        .dropdown-edit { position: absolute; z-index: 1000; background: white; border: 1px solid #ccc; min-width: 100px; }
        .chart-container { height: 400px; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-blue-600 text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-bold">Equipment Criticality Assessment System</h1>
                <div class="flex space-x-4">
                    <!-- Language Selector -->
                    <select id="languageSelector" class="bg-blue-500 text-white border-none rounded px-3 py-1">
                        <option value="en">ðŸ‡ºðŸ‡¸ English</option>
                        <option value="fr">ðŸ‡«ðŸ‡· FranÃ§ais</option>
                        <option value="de">ðŸ‡©ðŸ‡ª Deutsch</option>
                        <option value="es">ðŸ‡ªðŸ‡¸ EspaÃ±ol</option>
                    </select>
                    <!-- Currency Selector -->
                    <select id="currencySelector" class="bg-blue-500 text-white border-none rounded px-3 py-1">
                        <option value="USD">USD ($)</option>
                        <option value="EUR">EUR (â‚¬)</option>
                        <option value="GBP">GBP (Â£)</option>
                        <option value="CAD">CAD ($)</option>
                        <option value="AUD">AUD ($)</option>
                        <option value="JPY">JPY (Â¥)</option>
                    </select>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="bg-white shadow-md">
        <div class="container mx-auto px-4">
            <div class="flex space-x-0">
                <button class="tab-button px-6 py-3 border-b-2 border-transparent hover:border-blue-500 active" onclick="showTab('dashboard')">
                    <i class="fas fa-tachometer-alt mr-2"></i><span data-translate="dashboard">Dashboard</span>
                </button>
                <button class="tab-button px-6 py-3 border-b-2 border-transparent hover:border-blue-500" onclick="showTab('import')">
                    <i class="fas fa-upload mr-2"></i><span data-translate="import_assets">Import Assets</span>
                </button>
                <button class="tab-button px-6 py-3 border-b-2 border-transparent hover:border-blue-500" onclick="showTab('batch')">
                    <i class="fas fa-table mr-2"></i><span data-translate="batch_assessment">Batch Assessment</span>
                </button>
                <button class="tab-button px-6 py-3 border-b-2 border-transparent hover:border-blue-500" onclick="showTab('management')">
                    <i class="fas fa-cogs mr-2"></i><span data-translate="asset_management">Asset Management</span>
                </button>
                <button class="tab-button px-6 py-3 border-b-2 border-transparent hover:border-blue-500" onclick="showTab('reports')">
                    <i class="fas fa-file-pdf mr-2"></i><span data-translate="reports">Reports</span>
                </button>
                <button class="tab-button px-6 py-3 border-b-2 border-transparent hover:border-blue-500" onclick="showTab('settings')">
                    <i class="fas fa-cog mr-2"></i><span data-translate="settings">Settings</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold text-gray-700" data-translate="total_assets">Total Assets</h3>
                    <p class="text-3xl font-bold text-blue-600" id="totalAssets">0</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold text-gray-700" data-translate="critical_assets">Critical Assets</h3>
                    <p class="text-3xl font-bold text-red-600" id="criticalAssets">0</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold text-gray-700" data-translate="assessment_progress">Assessment Progress</h3>
                    <p class="text-3xl font-bold text-green-600" id="assessmentProgress">0%</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold text-gray-700" data-translate="avg_criticality">Avg Criticality</h3>
                    <p class="text-3xl font-bold text-orange-600" id="avgCriticality">0</p>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-semibold mb-4" data-translate="criticality_distribution">Criticality Distribution</h3>
                    <div class="chart-container">
                        <canvas id="criticalityChart"></canvas>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-semibold mb-4" data-translate="asset_types">Asset Types</h3>
                    <div class="chart-container">
                        <canvas id="assetTypesChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Import Assets Tab -->
        <div id="import" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-2xl font-bold mb-6" data-translate="import_assets">Import Assets</h2>
                
                <!-- Import Validation Instructions -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-blue-800 mb-4">
                        <i class="fas fa-info-circle mr-2"></i><span data-translate="import_instructions">Import Instructions</span>
                    </h3>
                    <ul class="text-blue-700 space-y-2">
                        <li>â€¢ <span data-translate="asset_id_unique">Asset ID must be unique</span></li>
                        <li>â€¢ <span data-translate="asset_name_required">Asset Name is required</span></li>
                        <li>â€¢ <span data-translate="type_must_be">Type must be one of: Rotating, Fixed, Mobile, Electrical, Instrumentation</span></li>
                        <li>â€¢ <span data-translate="location_specify">Location should specify facility/area</span></li>
                        <li>â€¢ <span data-translate="optional_fields">Optional fields: Description, Manufacturer, Model, Install Date</span></li>
                    </ul>
                </div>

                <!-- File Upload -->
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-6">
                    <i class="fas fa-upload text-4xl text-gray-400 mb-4"></i>
                    <p class="text-lg mb-4" data-translate="drag_drop_files">Drag and drop your CSV/Excel file here, or click to browse</p>
                    <input type="file" id="fileInput" class="hidden" accept=".csv,.xlsx,.xls" onchange="handleFileUpload(event)">
                    <button onclick="document.getElementById('fileInput').click()" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">
                        <span data-translate="browse_files">Browse Files</span>
                    </button>
                </div>

                <!-- Template Download -->
                <div class="mb-6">
                    <button onclick="downloadTemplate()" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700">
                        <i class="fas fa-download mr-2"></i><span data-translate="download_template">Download CSV Template</span>
                    </button>
                </div>

                <!-- Import Preview -->
                <div id="importPreview" class="hidden">
                    <h3 class="text-lg font-semibold mb-4" data-translate="import_preview">Import Preview</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full border-collapse border border-gray-300">
                            <thead id="previewTableHead"></thead>
                            <tbody id="previewTableBody"></tbody>
                        </table>
                    </div>
                    <div class="mt-4 flex space-x-4">
                        <button onclick="confirmImport()" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">
                            <span data-translate="confirm_import">Confirm Import</span>
                        </button>
                        <button onclick="cancelImport()" class="bg-gray-600 text-white px-6 py-2 rounded hover:bg-gray-700">
                            <span data-translate="cancel">Cancel</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Batch Assessment Tab -->
        <div id="batch" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold" data-translate="batch_assessment">Batch Assessment</h2>
                    <div class="flex space-x-4">
                        <button onclick="addNewAsset()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                            <i class="fas fa-plus mr-2"></i><span data-translate="add_asset">Add Asset</span>
                        </button>
                        <button onclick="bulkEdit()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                            <i class="fas fa-edit mr-2"></i><span data-translate="bulk_edit">Bulk Edit</span>
                        </button>
                        <button onclick="exportAssets()" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">
                            <i class="fas fa-download mr-2"></i><span data-translate="export">Export</span>
                        </button>
                    </div>
                </div>

                <!-- Filters -->
                <div class="mb-6 flex flex-wrap gap-4">
                    <input type="text" id="searchAssets" placeholder="Search assets..." class="border border-gray-300 rounded px-3 py-2" oninput="filterAssets()">
                    <select id="filterType" class="border border-gray-300 rounded px-3 py-2" onchange="filterAssets()">
                        <option value="">All Types</option>
                        <option value="Rotating">Rotating</option>
                        <option value="Fixed">Fixed</option>
                        <option value="Mobile">Mobile</option>
                        <option value="Electrical">Electrical</option>
                        <option value="Instrumentation">Instrumentation</option>
                    </select>
                    <select id="filterTier" class="border border-gray-300 rounded px-3 py-2" onchange="filterAssets()">
                        <option value="">All Criticality Tiers</option>
                        <option value="Critical">Critical (Tier 1)</option>
                        <option value="High">High (Tier 2)</option>
                        <option value="Medium">Medium (Tier 3)</option>
                        <option value="Low">Low (Tier 4)</option>
                    </select>
                </div>

                <!-- Editable Assets Table -->
                <div class="overflow-x-auto">
                    <table id="assetsTable" class="min-w-full border-collapse border border-gray-300">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="border border-gray-300 px-3 py-2 text-left">
                                    <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                                </th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="asset_id">Asset ID</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="asset_name">Asset Name</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="type">Type</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="location">Location</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="manufacturer">Manufacturer</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="model">Model</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="install_date">Install Date</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="safety_score">Safety</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="environmental_score">Environmental</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="production_score">Production</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="financial_score">Financial</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="quality_score">Quality</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="reputation_score">Reputation</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="criticality_tier">Tier</th>
                                <th class="border border-gray-300 px-3 py-2 text-left" data-translate="actions">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="assetsTableBody">
                            <!-- Assets will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Asset Management Tab -->
        <div id="management" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-2xl font-bold mb-6" data-translate="individual_asset_management">Individual Asset Management</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Asset Selection -->
                    <div class="lg:col-span-1">
                        <h3 class="text-lg font-semibold mb-4" data-translate="select_asset">Select Asset</h3>
                        <div id="assetList" class="space-y-2 max-h-96 overflow-y-auto">
                            <!-- Asset list will be populated here -->
                        </div>
                    </div>

                    <!-- Asset Details -->
                    <div class="lg:col-span-2">
                        <div id="assetDetails" class="hidden">
                            <h3 class="text-lg font-semibold mb-4" data-translate="asset_details">Asset Details</h3>
                            <form id="assetForm" class="space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700" data-translate="asset_id">Asset ID</label>
                                        <input type="text" id="detailAssetId" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" readonly>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700" data-translate="asset_name">Asset Name</label>
                                        <input type="text" id="detailAssetName" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700" data-translate="type">Type</label>
                                        <select id="detailType" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
                                            <option value="Rotating">Rotating</option>
                                            <option value="Fixed">Fixed</option>
                                            <option value="Mobile">Mobile</option>
                                            <option value="Electrical">Electrical</option>
                                            <option value="Instrumentation">Instrumentation</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700" data-translate="location">Location</label>
                                        <input type="text" id="detailLocation" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
                                    </div>
                                </div>

                                <!-- Scoring Section -->
                                <div class="mt-6">
                                    <h4 class="text-md font-semibold mb-4" data-translate="criticality_scoring">Criticality Scoring</h4>
                                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700" data-translate="safety_score">Safety Score</label>
                                            <select id="detailSafetyScore" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" onchange="updateDetailCriticality()">
                                                <option value="1">1 - No impact</option>
                                                <option value="2">2 - Negligible</option>
                                                <option value="3">3 - Minor injury</option>
                                                <option value="4">4 - Minor treatment</option>
                                                <option value="5">5 - OSHA recordable</option>
                                                <option value="6">6 - Medical treatment</option>
                                                <option value="7">7 - Lost time injury</option>
                                                <option value="8">8 - Hospitalization</option>
                                                <option value="9">9 - Serious injury</option>
                                                <option value="10">10 - Fatality</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700" data-translate="environmental_score">Environmental Score</label>
                                            <select id="detailEnvironmentalScore" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" onchange="updateDetailCriticality()">
                                                <option value="1">1 - No impact</option>
                                                <option value="2">2 - Minimal concern</option>
                                                <option value="3">3 - Minor contained</option>
                                                <option value="4">4 - Minor cleanup</option>
                                                <option value="5">5 - Below RQ</option>
                                                <option value="6">6 - Approaching RQ</option>
                                                <option value="7">7 - Contained above RQ</option>
                                                <option value="8">8 - Uncontained on-site</option>
                                                <option value="9">9 - Uncontained above RQ</option>
                                                <option value="10">10 - Off-site impact</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700" data-translate="production_score">Production Score</label>
                                            <select id="detailProductionScore" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" onchange="updateDetailCriticality()">
                                                <option value="1">1 - No impact</option>
                                                <option value="2">2 - Minimal disruption</option>
                                                <option value="3">3 - <1 hour delay</option>
                                                <option value="4">4 - 1-2 hours</option>
                                                <option value="5">5 - 1-8 hours</option>
                                                <option value="6">6 - 8-16 hours</option>
                                                <option value="7">7 - 8-24 hours</option>
                                                <option value="8">8 - 1-3 days</option>
                                                <option value="9">9 - 1-7 days</option>
                                                <option value="10">10 - >7 days</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700" data-translate="financial_score">Financial Score</label>
                                            <select id="detailFinancialScore" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" onchange="updateDetailCriticality()">
                                                <option value="1">1 - <$1K</option>
                                                <option value="2">2 - $1K-$5K</option>
                                                <option value="3">3 - $1K-$10K</option>
                                                <option value="4">4 - $10K-$25K</option>
                                                <option value="5">5 - $10K-$100K</option>
                                                <option value="6">6 - $100K-$250K</option>
                                                <option value="7">7 - $100K-$1M</option>
                                                <option value="8">8 - $1M-$5M</option>
                                                <option value="9">9 - $1M-$10M</option>
                                                <option value="10">10 - >$10M</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700" data-translate="quality_score">Quality Score</label>
                                            <select id="detailQualityScore" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" onchange="updateDetailCriticality()">
                                                <option value="1">1 - No impact</option>
                                                <option value="2">2 - Minimal concern</option>
                                                <option value="3">3 - Minor deviation</option>
                                                <option value="4">4 - Documentation required</option>
                                                <option value="5">5 - Requires rework</option>
                                                <option value="6">6 - Affects specifications</option>
                                                <option value="7">7 - Quarantine potential</option>
                                                <option value="8">8 - Investigation potential</option>
                                                <option value="9">9 - Non-compliance</option>
                                                <option value="10">10 - Customer safety</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700" data-translate="reputation_score">Reputation Score</label>
                                            <select id="detailReputationScore" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" onchange="updateDetailCriticality()">
                                                <option value="1">1 - No impact</option>
                                                <option value="2">2 - Minimal concern</option>
                                                <option value="3">3 - Internal complaint</option>
                                                <option value="4">4 - Customer inquiry</option>
                                                <option value="5">5 - Customer complaint</option>
                                                <option value="6">6 - Dissatisfaction</option>
                                                <option value="7">7 - Contract penalty</option>
                                                <option value="8">8 - Relationship damage</option>
                                                <option value="9">9 - Major customer loss</option>
                                                <option value="10">10 - Brand damage</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Criticality Result -->
                                <div class="mt-6 p-4 bg-gray-50 rounded">
                                    <h4 class="text-md font-semibold mb-2" data-translate="criticality_result">Criticality Result</h4>
                                    <div class="flex items-center space-x-4">
                                        <span data-translate="calculated_score">Calculated Score:</span>
                                        <span id="detailCalculatedScore" class="font-bold">0</span>
                                        <span data-translate="tier">Tier:</span>
                                        <span id="detailTier" class="font-bold px-2 py-1 rounded">-</span>
                                    </div>
                                </div>

                                <!-- Notes -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700" data-translate="notes">Notes</label>
                                    <textarea id="detailNotes" rows="4" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" placeholder="Add notes about this asset..."></textarea>
                                </div>

                                <!-- Save Button -->
                                <div class="flex justify-end">
                                    <button type="button" onclick="saveAssetDetails()" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">
                                        <span data-translate="save_changes">Save Changes</span>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-2xl font-bold mb-6" data-translate="reports">Reports</h2>
                
                <!-- Report Generation -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-lg font-semibold mb-4" data-translate="report_generation">Report Generation</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700" data-translate="report_type">Report Type</label>
                                <select id="reportType" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
                                    <option value="comprehensive">Comprehensive Assessment Report</option>
                                    <option value="executive">Executive Summary</option>
                                    <option value="maintenance">Maintenance Priority List</option>
                                    <option value="compliance">Compliance Audit Report</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700" data-translate="include_assets">Include Assets</label>
                                <select id="includeAssets" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
                                    <option value="all">All Assets</option>
                                    <option value="critical">Critical Assets Only</option>
                                    <option value="selected">Selected Assets Only</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700" data-translate="company_name">Company Name</label>
                                <input type="text" id="companyName" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" placeholder="Enter company name">
                            </div>

                            <div class="flex space-x-4">
                                <button onclick="generatePDFReport()" class="bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700">
                                    <i class="fas fa-file-pdf mr-2"></i><span data-translate="generate_pdf">Generate PDF</span>
                                </button>
                                <button onclick="exportToExcel()" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700">
                                    <i class="fas fa-file-excel mr-2"></i><span data-translate="export_excel">Export Excel</span>
                                </button>
                                <button onclick="exportToCSV()" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">
                                    <i class="fas fa-file-csv mr-2"></i><span data-translate="export_csv">Export CSV</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold mb-4" data-translate="maintenance_priority_matrix">Maintenance Priority Matrix</h3>
                        <div class="chart-container">
                            <canvas id="priorityMatrix"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Action Plan Summary -->
                <div class="mt-8">
                    <h3 class="text-lg font-semibold mb-4" data-translate="action_plan_summary">Action Plan Summary</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                            <h4 class="font-semibold text-red-800" data-translate="tier_1_critical">Tier 1 - Critical</h4>
                            <ul class="text-sm text-red-700 mt-2 space-y-1">
                                <li>â€¢ Predictive maintenance programs</li>
                                <li>â€¢ Real-time monitoring systems</li>
                                <li>â€¢ Emergency response procedures</li>
                                <li>â€¢ Root cause analysis</li>
                            </ul>
                        </div>
                        <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                            <h4 class="font-semibold text-orange-800" data-translate="tier_2_high">Tier 2 - High</h4>
                            <ul class="text-sm text-orange-700 mt-2 space-y-1">
                                <li>â€¢ Risk-based inspections</li>
                                <li>â€¢ Scheduled PdM activities</li>
                                <li>â€¢ Enhanced PM programs</li>
                                <li>â€¢ Failure mode analysis</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <h4 class="font-semibold text-yellow-800" data-translate="tier_3_medium">Tier 3 - Medium</h4>
                            <ul class="text-sm text-yellow-700 mt-2 space-y-1">
                                <li>â€¢ Standard preventive maintenance</li>
                                <li>â€¢ Basic condition monitoring</li>
                                <li>â€¢ OEM recommended maintenance</li>
                                <li>â€¢ Standard spare parts inventory</li>
                            </ul>
                        </div>
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h4 class="font-semibold text-green-800" data-translate="tier_4_low">Tier 4 - Low</h4>
                            <ul class="text-sm text-green-700 mt-2 space-y-1">
                                <li>â€¢ Run-to-failure strategy</li>
                                <li>â€¢ Minimal intervention</li>
                                <li>â€¢ Cost optimization focus</li>
                                <li>â€¢ Basic operator monitoring</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-2xl font-bold mb-6" data-translate="settings">Settings</h2>
                
                <!-- Criteria Weighting Configuration -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4" data-translate="criteria_weighting">Criteria Weighting Configuration</h3>
                    <div class="bg-gray-50 p-6 rounded-lg">
                        
                        <!-- Industry Templates -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="industry_template">Industry Template</label>
                            <select id="industryTemplate" class="block w-full border-gray-300 rounded-md shadow-sm" onchange="loadIndustryWeights()">
                                <option value="custom">Custom</option>
                                <option value="manufacturing">Manufacturing</option>
                                <option value="oil_gas">Oil & Gas</option>
                                <option value="chemical">Chemical Processing</option>
                                <option value="pharmaceutical">Pharmaceutical</option>
                                <option value="power">Power Generation</option>
                            </select>
                        </div>

                        <!-- Weight Sliders -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-translate="safety_weight">Safety Weight</span>: <span id="safetyWeightValue">25</span>%
                                </label>
                                <input type="range" id="safetyWeight" min="0" max="100" value="25" class="w-full" oninput="updateWeights()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-translate="environmental_weight">Environmental Weight</span>: <span id="environmentalWeightValue">15</span>%
                                </label>
                                <input type="range" id="environmentalWeight" min="0" max="100" value="15" class="w-full" oninput="updateWeights()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-translate="production_weight">Production Weight</span>: <span id="productionWeightValue">25</span>%
                                </label>
                                <input type="range" id="productionWeight" min="0" max="100" value="25" class="w-full" oninput="updateWeights()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-translate="financial_weight">Financial Weight</span>: <span id="financialWeightValue">20</span>%
                                </label>
                                <input type="range" id="financialWeight" min="0" max="100" value="20" class="w-full" oninput="updateWeights()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-translate="quality_weight">Quality Weight</span>: <span id="qualityWeightValue">10</span>%
                                </label>
                                <input type="range" id="qualityWeight" min="0" max="100" value="10" class="w-full" oninput="updateWeights()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-translate="reputation_weight">Reputation Weight</span>: <span id="reputationWeightValue">5</span>%
                                </label>
                                <input type="range" id="reputationWeight" min="0" max="100" value="5" class="w-full" oninput="updateWeights()">
                            </div>
                        </div>

                        <!-- Total Weight Display -->
                        <div class="mt-4 p-4 bg-white rounded border">
                            <div class="flex justify-between items-center">
                                <span class="font-medium" data-translate="total_weight">Total Weight:</span>
                                <span id="totalWeight" class="font-bold text-lg">100%</span>
                            </div>
                            <div id="weightWarning" class="text-red-600 text-sm mt-2 hidden">
                                Warning: Total weight should equal 100%
                            </div>
                        </div>

                        <!-- Weight Visualization -->
                        <div class="mt-6">
                            <h4 class="text-md font-semibold mb-2" data-translate="weight_distribution">Weight Distribution</h4>
                            <div class="chart-container">
                                <canvas id="weightChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Customize Impact Criteria -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4" data-translate="customize_impact_criteria">Customize Impact Criteria</h3>
                    
                    <!-- Predefined vs Custom Toggle -->
                    <div class="mb-6">
                        <div class="flex items-center space-x-4">
                            <label class="flex items-center">
                                <input type="radio" name="criteriaMode" value="predefined" checked class="mr-2" onchange="toggleCriteriaMode()">
                                <span data-translate="use_predefined">Use Predefined ISO-Standard Criteria</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="criteriaMode" value="custom" class="mr-2" onchange="toggleCriteriaMode()">
                                <span data-translate="use_custom">Use Custom Criteria</span>
                            </label>
                        </div>
                    </div>

                    <!-- Criteria Customization Panels -->
                    <div id="criteriaPanels" class="space-y-6">
                        <!-- Safety Criteria -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <h4 class="text-lg font-semibold mb-4 text-red-700" data-translate="safety_impact_criteria">Safety Impact Criteria</h4>
                            <div id="safetyCriteria" class="space-y-2">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Environmental Criteria -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <h4 class="text-lg font-semibold mb-4 text-green-700" data-translate="environmental_impact_criteria">Environmental Impact Criteria</h4>
                            <div id="environmentalCriteria" class="space-y-2">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Production Criteria -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <h4 class="text-lg font-semibold mb-4 text-blue-700" data-translate="production_impact_criteria">Production Impact Criteria</h4>
                            <div id="productionCriteria" class="space-y-2">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Financial Criteria -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <h4 class="text-lg font-semibold mb-4 text-yellow-700" data-translate="financial_impact_criteria">Financial Impact Criteria</h4>
                            <div id="financialCriteria" class="space-y-2">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Quality Criteria -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <h4 class="text-lg font-semibold mb-4 text-purple-700" data-translate="quality_impact_criteria">Quality Impact Criteria</h4>
                            <div id="qualityCriteria" class="space-y-2">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Reputation Criteria -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <h4 class="text-lg font-semibold mb-4 text-indigo-700" data-translate="reputation_impact_criteria">Reputation Impact Criteria</h4>
                            <div id="reputationCriteria" class="space-y-2">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Reset Button -->
                    <div class="mt-6">
                        <button onclick="resetToISOStandards()" class="bg-gray-600 text-white px-6 py-2 rounded hover:bg-gray-700">
                            <span data-translate="reset_to_iso">Reset to ISO Standards</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Global variables
        let assets = [
            {
                id: 'PUMP-001',
                name: 'Main Feed Pump',
                type: 'Rotating',
                location: 'Plant A - Area 1',
                manufacturer: 'ABC Corp',
                model: 'Model X',
                installDate: '2020-01-15',
                safetyScore: 5,
                environmentalScore: 3,
                productionScore: 7,
                financialScore: 6,
                qualityScore: 4,
                reputationScore: 2,
                notes: ''
            },
            {
                id: 'TANK-001',
                name: 'Storage Tank',
                type: 'Fixed',
                location: 'Plant A - Area 2',
                manufacturer: 'XYZ Inc',
                model: 'Model Y',
                installDate: '2019-05-20',
                safetyScore: 3,
                environmentalScore: 6,
                productionScore: 4,
                financialScore: 5,
                qualityScore: 5,
                reputationScore: 3,
                notes: ''
            }
        ];

        let currentLanguage = 'en';
        let currentCurrency = 'USD';
        let importData = [];
        let charts = {};

        // Weights configuration
        let weights = {
            safety: 25,
            environmental: 15,
            production: 25,
            financial: 20,
            quality: 10,
            reputation: 5
        };

        // ISO Standard Criteria
        const isoCriteria = {
            safety: [
                "No safety impact",
                "Negligible safety concern",
                "Minor injury potential (first aid)",
                "Minor injury with treatment",
                "OSHA recordable injury potential",
                "Medical treatment required",
                "Lost time injury potential",
                "Serious injury with hospitalization",
                "Serious injury potential",
                "Fatality or multiple fatality potential"
            ],
            environmental: [
                "No environmental impact",
                "Minimal environmental concern",
                "Minor on-site contained release",
                "Minor on-site release with cleanup",
                "On-site release below reportable quantity (RQ)",
                "On-site release approaching RQ",
                "On-site contained release above RQ",
                "Uncontained on-site release above RQ",
                "Uncontained release above RQ",
                "Release affecting off-site vegetation or waterways"
            ],
            production: [
                "No production impact",
                "Minimal operational disruption",
                "Minor production delay (<1 hour)",
                "Short production delay (1-2 hours)",
                "Moderate production impact (1-8 hours)",
                "Significant operational disruption (8-16 hours)",
                "Significant production loss (8-24 hours)",
                "Major production disruption (1-3 days)",
                "Major production shutdown (1-7 days)",
                "Extended shutdown (>7 days)"
            ],
            financial: [
                "<$1,000 impact",
                "$1,000-$5,000 impact",
                "$1,000-$10,000 impact",
                "$10,000-$25,000 impact",
                "$10,000-$100,000 impact",
                "$100,000-$250,000 impact",
                "$100,000-$1,000,000 impact",
                "$1,000,000-$5,000,000 impact",
                "$1,000,000-$10,000,000 impact",
                ">$10,000,000 impact"
            ],
            quality: [
                "No quality impact",
                "Minimal quality concern",
                "Minor quality deviation (internal)",
                "Quality deviation requiring documentation",
                "Quality impact requiring rework",
                "Product quality affecting specifications",
                "Product quarantine or recall potential",
                "Regulatory investigation potential",
                "Regulatory non-compliance",
                "Customer safety/product efficacy impact"
            ],
            reputation: [
                "No customer impact",
                "Minimal stakeholder concern",
                "Internal complaint",
                "Customer inquiry or concern",
                "Customer complaint",
                "Customer dissatisfaction",
                "Customer contract penalty",
                "Customer relationship damage",
                "Loss of major customer",
                "Brand damage/public relations crisis"
            ]
        };

        // Translations
        const translations = {
            en: {
                dashboard: "Dashboard",
                import_assets: "Import Assets",
                batch_assessment: "Batch Assessment",
                asset_management: "Asset Management",
                reports: "Reports",
                settings: "Settings",
                total_assets: "Total Assets",
                critical_assets: "Critical Assets",
                assessment_progress: "Assessment Progress",
                avg_criticality: "Avg Criticality",
                criticality_distribution: "Criticality Distribution",
                asset_types: "Asset Types"
            },
            fr: {
                dashboard: "Tableau de Bord",
                import_assets: "Importer Actifs",
                batch_assessment: "Ã‰valuation par Lots",
                asset_management: "Gestion d'Actifs",
                reports: "Rapports",
                settings: "ParamÃ¨tres",
                total_assets: "Total des Actifs",
                critical_assets: "Actifs Critiques",
                assessment_progress: "ProgrÃ¨s d'Ã‰valuation",
                avg_criticality: "CriticitÃ© Moyenne",
                criticality_distribution: "Distribution de CriticitÃ©",
                asset_types: "Types d'Actifs"
            },
            de: {
                dashboard: "Dashboard",
                import_assets: "Anlagen Importieren",
                batch_assessment: "Stapel-Bewertung",
                asset_management: "Anlagenverwaltung",
                reports: "Berichte",
                settings: "Einstellungen",
                total_assets: "Gesamte Anlagen",
                critical_assets: "Kritische Anlagen",
                assessment_progress: "Bewertungsfortschritt",
                avg_criticality: "Durchschn. KritikalitÃ¤t",
                criticality_distribution: "KritikalitÃ¤tsverteilung",
                asset_types: "Anlagentypen"
            },
            es: {
                dashboard: "Panel de Control",
                import_assets: "Importar Activos",
                batch_assessment: "EvaluaciÃ³n por Lotes",
                asset_management: "GestiÃ³n de Activos",
                reports: "Informes",
                settings: "ConfiguraciÃ³n",
                total_assets: "Total de Activos",
                critical_assets: "Activos CrÃ­ticos",
                assessment_progress: "Progreso de EvaluaciÃ³n",
                avg_criticality: "Criticidad Promedio",
                criticality_distribution: "DistribuciÃ³n de Criticidad",
                asset_types: "Tipos de Activos"
            }
        };

        // Industry weight templates
        const industryWeights = {
            manufacturing: { safety: 25, environmental: 15, production: 25, financial: 20, quality: 10, reputation: 5 },
            oil_gas: { safety: 30, environmental: 25, production: 20, financial: 15, quality: 5, reputation: 5 },
            chemical: { safety: 30, environmental: 25, production: 20, financial: 15, quality: 7, reputation: 3 },
            pharmaceutical: { safety: 20, environmental: 15, production: 15, financial: 15, quality: 30, reputation: 5 },
            power: { safety: 35, environmental: 20, production: 25, financial: 15, quality: 3, reputation: 2 }
        };

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            populateAssetsTable();
            updateDashboard();
            loadCriteriaSettings();
            createCharts();
            updateWeightChart();
            populateAssetList();
            
            // Set up event listeners
            document.getElementById('languageSelector').addEventListener('change', changeLanguage);
            document.getElementById('currencySelector').addEventListener('change', changeCurrency);
        }

        // Tab Management
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });

            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });

            // Show selected tab content
            const selectedTab = document.getElementById(tabName);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }

            // Add active class to selected tab button
            event.target.classList.add('active');

            // Update charts when switching to dashboard
            if (tabName === 'dashboard') {
                setTimeout(updateCharts, 100);
            }
        }

        // Asset Management Functions
        function calculateCriticality(asset) {
            const weightedScore = (
                asset.safetyScore * weights.safety +
                asset.environmentalScore * weights.environmental +
                asset.productionScore * weights.production +
                asset.financialScore * weights.financial +
                asset.qualityScore * weights.quality +
                asset.reputationScore * weights.reputation
            ) / 100;

            return Math.round(weightedScore * 10) / 10;
        }

        function getCriticalityTier(score) {
            if (score >= 8) return { name: 'Critical', class: 'tier-critical' };
            if (score >= 6) return { name: 'High', class: 'tier-high' };
            if (score >= 4) return { name: 'Medium', class: 'tier-medium' };
            return { name: 'Low', class: 'tier-low' };
        }

        function populateAssetsTable() {
            const tbody = document.getElementById('assetsTableBody');
            tbody.innerHTML = '';

            assets.forEach((asset, index) => {
                const score = calculateCriticality(asset);
                const tier = getCriticalityTier(score);
                
                const row = document.createElement('tr');
                row.className = tier.class;
                row.innerHTML = `
                    <td class="border border-gray-300 px-3 py-2">
                        <input type="checkbox" class="asset-checkbox" data-index="${index}">
                    </td>
                    <td class="border border-gray-300 px-3 py-2 font-mono">${asset.id}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="name" data-index="${index}">${asset.name}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="type" data-index="${index}">${asset.type}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="location" data-index="${index}">${asset.location}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="manufacturer" data-index="${index}">${asset.manufacturer}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="model" data-index="${index}">${asset.model}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="installDate" data-index="${index}">${asset.installDate}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="safetyScore" data-index="${index}">${asset.safetyScore}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="environmentalScore" data-index="${index}">${asset.environmentalScore}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="productionScore" data-index="${index}">${asset.productionScore}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="financialScore" data-index="${index}">${asset.financialScore}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="qualityScore" data-index="${index}">${asset.qualityScore}</td>
                    <td class="border border-gray-300 px-3 py-2 editable-cell" data-field="reputationScore" data-index="${index}">${asset.reputationScore}</td>
                    <td class="border border-gray-300 px-3 py-2 font-semibold">${tier.name} (${score})</td>
                    <td class="border border-gray-300 px-3 py-2">
                        <button onclick="deleteAsset(${index})" class="text-red-600 hover:text-red-800">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            // Add click handlers for editable cells
            document.querySelectorAll('.editable-cell').forEach(cell => {
                cell.addEventListener('click', handleCellClick);
            });

            updateDashboard();
        }

        function handleCellClick(event) {
            const cell = event.target;
            const field = cell.dataset.field;
            const index = parseInt(cell.dataset.index);
            const currentValue = cell.textContent;

            // Don't edit if already editing
            if (cell.querySelector('input') || cell.querySelector('select')) {
                return;
            }

            let input;

            // Create appropriate input based on field type
            if (field.includes('Score')) {
                input = document.createElement('select');
                input.className = 'w-full border-none bg-transparent';
                for (let i = 1; i <= 10; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i;
                    if (i == currentValue) option.selected = true;
                    input.appendChild(option);
                }
            } else if (field === 'type') {
                input = document.createElement('select');
                input.className = 'w-full border-none bg-transparent';
                ['Rotating', 'Fixed', 'Mobile', 'Electrical', 'Instrumentation'].forEach(type => {
                    const option = document.createElement('option');
                    option.value = type;
                    option.textContent = type;
                    if (type === currentValue) option.selected = true;
                    input.appendChild(option);
                });
            } else if (field === 'installDate') {
                input = document.createElement('input');
                input.type = 'date';
                input.value = currentValue;
                input.className = 'w-full border-none bg-transparent';
            } else {
                input = document.createElement('input');
                input.type = 'text';
                input.value = currentValue;
                input.className = 'w-full border-none bg-transparent';
            }

            // Save on blur or enter
            function saveEdit() {
                const newValue = input.value;
                assets[index][field] = field.includes('Score') ? parseInt(newValue) : newValue;
                cell.textContent = newValue;
                populateAssetsTable(); // Refresh table to update criticality
            }

            input.addEventListener('blur', saveEdit);
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    saveEdit();
                }
            });

            cell.innerHTML = '';
            cell.appendChild(input);
            input.focus();
        }

        function addNewAsset() {
            const newId = `ASSET-${String(assets.length + 1).padStart(3, '0')}`;
            const newAsset = {
                id: newId,
                name: 'New Asset',
                type: 'Rotating',
                location: '',
                manufacturer: '',
                model: '',
                installDate: new Date().toISOString().split('T')[0],
                safetyScore: 1,
                environmentalScore: 1,
                productionScore: 1,
                financialScore: 1,
                qualityScore: 1,
                reputationScore: 1,
                notes: ''
            };
            assets.push(newAsset);
            populateAssetsTable();
            populateAssetList();
        }

        function deleteAsset(index) {
            if (confirm('Are you sure you want to delete this asset?')) {
                assets.splice(index, 1);
                populateAssetsTable();
                populateAssetList();
            }
        }

        function toggleSelectAll() {
            const selectAll = document.getElementById('selectAll');
            const checkboxes = document.querySelectorAll('.asset-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAll.checked;
            });
        }

        function bulkEdit() {
            const checkedBoxes = document.querySelectorAll('.asset-checkbox:checked');
            if (checkedBoxes.length === 0) {
                alert('Please select assets to edit.');
                return;
            }

            const field = prompt('Enter field to edit (safetyScore, environmentalScore, productionScore, financialScore, qualityScore, reputationScore, type, location):');
            if (!field) return;

            const value = prompt(`Enter new value for ${field}:`);
            if (!value) return;

            checkedBoxes.forEach(checkbox => {
                const index = parseInt(checkbox.dataset.index);
                if (field.includes('Score')) {
                    assets[index][field] = parseInt(value);
                } else {
                    assets[index][field] = value;
                }
            });

            populateAssetsTable();
            populateAssetList();
        }

        function filterAssets() {
            const searchTerm = document.getElementById('searchAssets').value.toLowerCase();
            const typeFilter = document.getElementById('filterType').value;
            const tierFilter = document.getElementById('filterTier').value;

            const rows = document.querySelectorAll('#assetsTableBody tr');
            
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                const assetName = cells[2].textContent.toLowerCase();
                const assetType = cells[3].textContent;
                const tierText = cells[14].textContent;

                const matchesSearch = assetName.includes(searchTerm);
                const matchesType = !typeFilter || assetType === typeFilter;
                const matchesTier = !tierFilter || tierText.includes(tierFilter);

                row.style.display = matchesSearch && matchesType && matchesTier ? '' : 'none';
            });
        }

        // Import/Export Functions
        function downloadTemplate() {
            const csvContent = `Asset ID,Asset Name,Type,Location,Manufacturer,Model,Install Date,Safety Score,Environmental Score,Production Score,Financial Score,Quality Score,Reputation Score
PUMP-001,Main Feed Pump,Rotating,Plant A - Area 1,ABC Corp,Model X,2020-01-15,5,3,7,6,4,2
TANK-001,Storage Tank,Fixed,Plant A - Area 2,XYZ Inc,Model Y,2019-05-20,3,6,4,5,5,3`;

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'asset_import_template.csv';
            a.click();
            URL.revokeObjectURL(url);
        }

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csv = e.target.result;
                    parseCSV(csv);
                } catch (error) {
                    alert('Error reading file: ' + error.message);
                }
            };
            reader.readAsText(file);
        }

        function parseCSV(csvText) {
            const lines = csvText.split('\n').filter(line => line.trim());
            const headers = lines[0].split(',').map(header => header.trim());
            
            console.log('CSV Headers:', headers);
            
            // Expected headers order
            const expectedHeaders = [
                'Asset ID', 'Asset Name', 'Type', 'Location', 'Manufacturer', 
                'Model', 'Install Date', 'Safety Score', 'Environmental Score', 
                'Production Score', 'Financial Score', 'Quality Score', 'Reputation Score'
            ];

            importData = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',').map(value => value.trim());
                console.log(`Row ${i} values:`, values);
                
                if (values.length >= 13) {
                    const asset = {
                        id: values[0] || `ASSET-${i}`,
                        name: values[1] || 'Unnamed Asset',
                        type: values[2] || 'Rotating',
                        location: values[3] || '',
                        manufacturer: values[4] || '',
                        model: values[5] || '',
                        installDate: values[6] || new Date().toISOString().split('T')[0],
                        safetyScore: parseInt(values[7]) || 1,
                        environmentalScore: parseInt(values[8]) || 1,
                        productionScore: parseInt(values[9]) || 1,
                        financialScore: parseInt(values[10]) || 1,
                        qualityScore: parseInt(values[11]) || 1,
                        reputationScore: parseInt(values[12]) || 1,
                        notes: ''
                    };
                    importData.push(asset);
                    console.log(`Parsed asset ${i}:`, asset);
                }
            }

            showImportPreview();
        }

        function showImportPreview() {
            const preview = document.getElementById('importPreview');
            const thead = document.getElementById('previewTableHead');
            const tbody = document.getElementById('previewTableBody');

            // Create header
            thead.innerHTML = `
                <tr class="bg-gray-50">
                    <th class="border border-gray-300 px-2 py-1">Asset ID</th>
                    <th class="border border-gray-300 px-2 py-1">Asset Name</th>
                    <th class="border border-gray-300 px-2 py-1">Type</th>
                    <th class="border border-gray-300 px-2 py-1">Location</th>
                    <th class="border border-gray-300 px-2 py-1">Manufacturer</th>
                    <th class="border border-gray-300 px-2 py-1">Model</th>
                    <th class="border border-gray-300 px-2 py-1">Install Date</th>
                    <th class="border border-gray-300 px-2 py-1">Safety</th>
                    <th class="border border-gray-300 px-2 py-1">Environmental</th>
                    <th class="border border-gray-300 px-2 py-1">Production</th>
                    <th class="border border-gray-300 px-2 py-1">Financial</th>
                    <th class="border border-gray-300 px-2 py-1">Quality</th>
                    <th class="border border-gray-300 px-2 py-1">Reputation</th>
                </tr>
            `;

            // Create rows
            tbody.innerHTML = '';
            importData.forEach(asset => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="border border-gray-300 px-2 py-1">${asset.id}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.name}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.type}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.location}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.manufacturer}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.model}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.installDate}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.safetyScore}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.environmentalScore}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.productionScore}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.financialScore}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.qualityScore}</td>
                    <td class="border border-gray-300 px-2 py-1">${asset.reputationScore}</td>
                `;
                tbody.appendChild(row);
            });

            preview.classList.remove('hidden');
        }

        function confirmImport() {
            assets = [...assets, ...importData];
            importData = [];
            populateAssetsTable();
            populateAssetList();
            cancelImport();
            alert(`Successfully imported ${importData.length} assets.`);
        }

        function cancelImport() {
            document.getElementById('importPreview').classList.add('hidden');
            document.getElementById('fileInput').value = '';
            importData = [];
        }

        function exportAssets() {
            let csvContent = 'Asset ID,Asset Name,Type,Location,Manufacturer,Model,Install Date,Safety Score,Environmental Score,Production Score,Financial Score,Quality Score,Reputation Score,Criticality Score,Tier\n';
            
            assets.forEach(asset => {
                const score = calculateCriticality(asset);
                const tier = getCriticalityTier(score);
                csvContent += `${asset.id},${asset.name},${asset.type},${asset.location},${asset.manufacturer},${asset.model},${asset.installDate},${asset.safetyScore},${asset.environmentalScore},${asset.productionScore},${asset.financialScore},${asset.qualityScore},${asset.reputationScore},${score},${tier.name}\n`;
            });

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'equipment_criticality_assessment.csv';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Dashboard Functions
        function updateDashboard() {
            const totalAssets = assets.length;
            const criticalAssets = assets.filter(asset => getCriticalityTier(calculateCriticality(asset)).name === 'Critical').length;
            const assessedAssets = assets.filter(asset => asset.safetyScore > 1 || asset.environmentalScore > 1).length;
            const avgCriticality = assets.reduce((sum, asset) => sum + calculateCriticality(asset), 0) / totalAssets || 0;

            document.getElementById('totalAssets').textContent = totalAssets;
            document.getElementById('criticalAssets').textContent = criticalAssets;
            document.getElementById('assessmentProgress').textContent = `${Math.round((assessedAssets / totalAssets) * 100) || 0}%`;
            document.getElementById('avgCriticality').textContent = avgCriticality.toFixed(1);
        }

        function createCharts() {
            // Destroy existing charts to prevent memory leaks
            Object.values(charts).forEach(chart => {
                if (chart && typeof chart.destroy === 'function') {
                    chart.destroy();
                }
            });
            charts = {};

            createCriticalityChart();
            createAssetTypesChart();
            createPriorityMatrix();
        }

        function createCriticalityChart() {
            const ctx = document.getElementById('criticalityChart');
            if (!ctx) return;

            const tierCounts = { Critical: 0, High: 0, Medium: 0, Low: 0 };
            assets.forEach(asset => {
                const tier = getCriticalityTier(calculateCriticality(asset)).name;
                tierCounts[tier]++;
            });

            charts.criticality = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Critical', 'High', 'Medium', 'Low'],
                    datasets: [{
                        data: [tierCounts.Critical, tierCounts.High, tierCounts.Medium, tierCounts.Low],
                        backgroundColor: ['#ef4444', '#f97316', '#eab308', '#22c55e']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createAssetTypesChart() {
            const ctx = document.getElementById('assetTypesChart');
            if (!ctx) return;

            const typeCounts = {};
            assets.forEach(asset => {
                typeCounts[asset.type] = (typeCounts[asset.type] || 0) + 1;
            });

            charts.assetTypes = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(typeCounts),
                    datasets: [{
                        label: 'Number of Assets',
                        data: Object.values(typeCounts),
                        backgroundColor: '#3b82f6'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function createPriorityMatrix() {
            const ctx = document.getElementById('priorityMatrix');
            if (!ctx) return;

            const data = assets.map(asset => ({
                x: calculateCriticality(asset),
                y: Math.random() * 10, // Placeholder for maintenance urgency
                label: asset.name
            }));

            charts.priorityMatrix = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Assets',
                        data: data,
                        backgroundColor: '#3b82f6'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Criticality Score'
                            },
                            min: 0,
                            max: 10
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Maintenance Urgency'
                            },
                            min: 0,
                            max: 10
                        }
                    }
                }
            });
        }

        function updateCharts() {
            createCharts();
        }

        // Asset Management Functions
        function populateAssetList() {
            const assetList = document.getElementById('assetList');
            assetList.innerHTML = '';

            assets.forEach((asset, index) => {
                const score = calculateCriticality(asset);
                const tier = getCriticalityTier(score);
                
                const assetItem = document.createElement('div');
                assetItem.className = `p-3 border rounded cursor-pointer hover:bg-gray-50 ${tier.class}`;
                assetItem.innerHTML = `
                    <div class="font-semibold">${asset.name}</div>
                    <div class="text-sm text-gray-600">${asset.id} - ${asset.type}</div>
                    <div class="text-sm font-medium">${tier.name} (${score})</div>
                `;
                assetItem.onclick = () => selectAsset(index);
                assetList.appendChild(assetItem);
            });
        }

        function selectAsset(index) {
            const asset = assets[index];
            const detailsDiv = document.getElementById('assetDetails');
            
            // Populate form
            document.getElementById('detailAssetId').value = asset.id;
            document.getElementById('detailAssetName').value = asset.name;
            document.getElementById('detailType').value = asset.type;
            document.getElementById('detailLocation').value = asset.location;
            document.getElementById('detailSafetyScore').value = asset.safetyScore;
            document.getElementById('detailEnvironmentalScore').value = asset.environmentalScore;
            document.getElementById('detailProductionScore').value = asset.productionScore;
            document.getElementById('detailFinancialScore').value = asset.financialScore;
            document.getElementById('detailQualityScore').value = asset.qualityScore;
            document.getElementById('detailReputationScore').value = asset.reputationScore;
            document.getElementById('detailNotes').value = asset.notes || '';

            // Store current asset index
            detailsDiv.dataset.assetIndex = index;
            
            // Show details panel
            detailsDiv.classList.remove('hidden');
            
            // Update criticality
            updateDetailCriticality();
        }

        function updateDetailCriticality() {
            const safetyScore = parseInt(document.getElementById('detailSafetyScore').value);
            const environmentalScore = parseInt(document.getElementById('detailEnvironmentalScore').value);
            const productionScore = parseInt(document.getElementById('detailProductionScore').value);
            const financialScore = parseInt(document.getElementById('detailFinancialScore').value);
            const qualityScore = parseInt(document.getElementById('detailQualityScore').value);
            const reputationScore = parseInt(document.getElementById('detailReputationScore').value);

            const tempAsset = {
                safetyScore, environmentalScore, productionScore,
                financialScore, qualityScore, reputationScore
            };

            const score = calculateCriticality(tempAsset);
            const tier = getCriticalityTier(score);

            document.getElementById('detailCalculatedScore').textContent = score;
            const tierSpan = document.getElementById('detailTier');
            tierSpan.textContent = tier.name;
            tierSpan.className = `font-bold px-2 py-1 rounded ${tier.class}`;
        }

        function saveAssetDetails() {
            const index = parseInt(document.getElementById('assetDetails').dataset.assetIndex);
            const asset = assets[index];

            asset.name = document.getElementById('detailAssetName').value;
            asset.type = document.getElementById('detailType').value;
            asset.location = document.getElementById('detailLocation').value;
            asset.safetyScore = parseInt(document.getElementById('detailSafetyScore').value);
            asset.environmentalScore = parseInt(document.getElementById('detailEnvironmentalScore').value);
            asset.productionScore = parseInt(document.getElementById('detailProductionScore').value);
            asset.financialScore = parseInt(document.getElementById('detailFinancialScore').value);
            asset.qualityScore = parseInt(document.getElementById('detailQualityScore').value);
            asset.reputationScore = parseInt(document.getElementById('detailReputationScore').value);
            asset.notes = document.getElementById('detailNotes').value;

            populateAssetsTable();
            populateAssetList();
            updateDashboard();
            
            alert('Asset details saved successfully!');
        }

        // Settings Functions
        function updateWeights() {
            weights.safety = parseInt(document.getElementById('safetyWeight').value);
            weights.environmental = parseInt(document.getElementById('environmentalWeight').value);
            weights.production = parseInt(document.getElementById('productionWeight').value);
            weights.financial = parseInt(document.getElementById('financialWeight').value);
            weights.quality = parseInt(document.getElementById('qualityWeight').value);
            weights.reputation = parseInt(document.getElementById('reputationWeight').value);

            // Update display values
            document.getElementById('safetyWeightValue').textContent = weights.safety;
            document.getElementById('environmentalWeightValue').textContent = weights.environmental;
            document.getElementById('productionWeightValue').textContent = weights.production;
            document.getElementById('financialWeightValue').textContent = weights.financial;
            document.getElementById('qualityWeightValue').textContent = weights.quality;
            document.getElementById('reputationWeightValue').textContent = weights.reputation;

            // Calculate total
            const total = Object.values(weights).reduce((sum, val) => sum + val, 0);
            document.getElementById('totalWeight').textContent = total + '%';

            // Show warning if not 100%
            const warning = document.getElementById('weightWarning');
            if (total !== 100) {
                warning.classList.remove('hidden');
            } else {
                warning.classList.add('hidden');
            }

            // Update weight chart
            updateWeightChart();

            // Refresh tables with new weights
            populateAssetsTable();
            populateAssetList();
            updateDashboard();

            // Set industry template to custom
            document.getElementById('industryTemplate').value = 'custom';
        }

        function loadIndustryWeights() {
            const template = document.getElementById('industryTemplate').value;
            if (template === 'custom') return;

            const templateWeights = industryWeights[template];
            if (!templateWeights) return;

            // Update weights
            Object.assign(weights, templateWeights);

            // Update sliders
            document.getElementById('safetyWeight').value = weights.safety;
            document.getElementById('environmentalWeight').value = weights.environmental;
            document.getElementById('productionWeight').value = weights.production;
            document.getElementById('financialWeight').value = weights.financial;
            document.getElementById('qualityWeight').value = weights.quality;
            document.getElementById('reputationWeight').value = weights.reputation;

            // Trigger update
            updateWeights();
        }

        function updateWeightChart() {
            const ctx = document.getElementById('weightChart');
            if (!ctx) return;

            // Destroy existing chart
            if (charts.weights) {
                charts.weights.destroy();
            }

            charts.weights = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Safety', 'Environmental', 'Production', 'Financial', 'Quality', 'Reputation'],
                    datasets: [{
                        data: [weights.safety, weights.environmental, weights.production, weights.financial, weights.quality, weights.reputation],
                        backgroundColor: ['#ef4444', '#22c55e', '#3b82f6', '#eab308', '#8b5cf6', '#6366f1']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function loadCriteriaSettings() {
            const criteriaTypes = ['safety', 'environmental', 'production', 'financial', 'quality', 'reputation'];
            
            criteriaTypes.forEach(type => {
                const container = document.getElementById(`${type}Criteria`);
                container.innerHTML = '';
                
                isoCriteria[type].forEach((description, index) => {
                    const level = index + 1;
                    const div = document.createElement('div');
                    div.className = 'flex items-center space-x-2';
                    div.innerHTML = `
                        <span class="w-8 text-sm font-medium">L${level}:</span>
                        <input type="text" value="${description}" class="flex-1 text-sm border border-gray-300 rounded px-2 py-1" 
                               id="${type}_level_${level}" readonly>
                    `;
                    container.appendChild(div);
                });
            });
        }

        function toggleCriteriaMode() {
            const mode = document.querySelector('input[name="criteriaMode"]:checked').value;
            const inputs = document.querySelectorAll('#criteriaPanels input[type="text"]');
            
            inputs.forEach(input => {
                input.readOnly = mode === 'predefined';
                input.classList.toggle('bg-gray-100', mode === 'predefined');
            });
        }

        function resetToISOStandards() {
            document.querySelector('input[name="criteriaMode"][value="predefined"]').checked = true;
            loadCriteriaSettings();
            toggleCriteriaMode();
        }

        // Report Functions
        function generatePDFReport() {
            alert('PDF report generation would be implemented here. This is a demo feature.');
        }

        function exportToExcel() {
            alert('Excel export would be implemented here. This is a demo feature.');
        }

        function exportToCSV() {
            exportAssets();
        }

        // Language and Currency Functions
        function changeLanguage() {
            currentLanguage = document.getElementById('languageSelector').value;
            updateTranslations();
        }

        function changeCurrency() {
            currentCurrency = document.getElementById('currencySelector').value;
            updateFinancialCriteria();
        }

        function updateTranslations() {
            const elements = document.querySelectorAll('[data-translate]');
            elements.forEach(element => {
                const key = element.dataset.translate;
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
        }

        function updateFinancialCriteria() {
            // Update financial criteria based on selected currency
            // This would implement currency conversion logic
            console.log('Currency changed to:', currentCurrency);
        }
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"953f3036ecc3d086","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.6.2","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDh%2BHRQ9qsd3G%2Bd8wfvIfaUt72kC%2Bc3dwDN7P2dRuzSbuBgGHASqPhHkvGeVRRyfVljAIF%2BNGPnRbHjG71kgr3Uth%2BPcW5k5BSeE0TFUzy7hEjrxI7p3fgCICGdQRhOLRPXlipIHAwyZtZ4Fx4rbuYrAKDdbpBZ9I8jrKQV8XenftYr7AIsFXDm%2FQSq9So0UFVeVpcUm4tIgFKTptorXPyWkAULJIq1tEjUjAkr3sobApncwZeX%2FrK%2BQLtE3x0Cdt4SsK3bYk1nfH61wQ1HNabAw5Q41AjD4pc%2FpYPSMbNZgLGlIBm44fiW3jMkhWKjoOwsKs%2BZ%2BOsbO2pHkf%2FNOS8YdjK8As3L2hvCyiEkzAOuwMyGgDA0LHlQmAxOODQIznjuILnvoCeLR%2Fel7DUn0x8lFFikjo1tFiWiiN9KhmEk9b6UG6Yn7Fn6l4i9pbvAIHiuaK6vSqCtdmjOndQNb6vS1Dw6LXNSrYbR2FtAEi8GZohv7Sl98W0DsHMp2zZDsL0fAVF1osAZhtnhur%2FTrSAgfAEw7KOnpXktWco4mUUW0y";
        window.__genspark_locale = "en-US";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDh+HRQ9qsd3G+d8wfvIfaUt72kC+c3dwDN7P2dRuzSbuBgGHASqPhHkvGeVRRyfVljAIF+NGPnRbHjG71kgr3Uth+PcW5k5BSeE0TFUzy7hEjrxI7p3fgCICGdQRhOLRPXlipIHAwyZtZ4Fx4rbuYrAKDdbpBZ9I8jrKQV8XenftYr7AIsFXDm/QSq9So0UFVeVpcUm4tIgFKTptorXPyWkAULJIq1tEjUjAkr3sobApncwZeX/rK+QLtE3x0Cdt4SsK3bYk1nfH61wQ1HNabAw5Q41AjD4pc/pYPSMbNZgLGlIBm44fiW3jMkhWKjoOwsKs+Z+OsbO2pHkf/NOS8YdjK8As3L2hvCyiEkzAOuwMyGgDA0LHlQmAxOODQIznjuILnvoCeLR/el7DUn0x8lFFikjo1tFiWiiN9KhmEk9b6UG6Yn7Fn6l4i9pbvAIHiuaK6vSqCtdmjOndQNb6vS1Dw6LXNSrYbR2FtAEi8GZohv7Sl98W0DsHMp2zZDsL0fAVF1osAZhtnhur/TrSAgfAEw7KOnpXktWco4mUUW0y";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    